<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ðŸŽ‚ Birthday Magic</title>

<script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_detection/face_detection.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>

<style>
*{box-sizing:border-box}
body{
  margin:0;height:100vh;
  display:flex;justify-content:center;align-items:center;
  background:radial-gradient(circle,#ff4e8e,#120018);
  font-family:'Poppins',Arial;color:white;
  overflow:hidden
}

/* ðŸ’– flying hearts */
.heart{
  position:fixed;
  font-size:22px;
  animation:floatUp linear infinite;
  pointer-events:none;
}
@keyframes floatUp{
  from{bottom:-10%;opacity:1}
  to{bottom:110%;opacity:0}
}

/* âœ¨ glowing stickers */
.sticker{
  position:fixed;
  width:140px;
  animation:float 3s ease-in-out infinite alternate,
           glow 2s infinite alternate;
}
@keyframes float{to{transform:translateY(-18px)}}
@keyframes glow{
  from{filter:drop-shadow(0 0 6px #ff2e63)}
  to{filter:drop-shadow(0 0 18px #ff9a9e)}
}
.tl{top:18px;left:18px}
.br{bottom:18px;right:18px}

/* camera box */
.wrap{text-align:center;z-index:2}
.box{
  position:relative;
  border-radius:30px;
  overflow:hidden;
  box-shadow:0 0 140px rgba(255,46,99,1);
}
video,canvas{
  width:92vw;max-width:440px;
  height:68vw;max-height:330px;
  object-fit:cover;
}
.frame{
  position:absolute;inset:0;
  border:16px solid #ff2e63;
  border-radius:30px;
}

/* countdown */
#count{
  position:absolute;inset:0;
  display:flex;justify-content:center;align-items:center;
  font-size:120px;
  background:rgba(0,0,0,.6);
  animation:pulse .7s infinite alternate;
}
@keyframes pulse{to{transform:scale(1.15)}}

/* flash */
#flash{
  position:fixed;inset:0;
  background:white;
  opacity:0;
}

/* result */
.hb{
  font-size:48px;
  margin:18px 0;
}
.gifs img{
  width:120px;
  margin:10px;
  border-radius:20px;
}

/* ðŸŽŠ confetti */
.confetti{
  position:fixed;
  font-size:26px;
  animation:fall linear infinite;
}
@keyframes fall{
  from{top:-10%}
  to{top:110%}
}

/* mobile hint */
.tap{
  position:fixed;
  bottom:12px;
  font-size:14px;
  opacity:.7;
}
</style>
</head>

<body>

<!-- âœ¨ animated stickers (GIFs) -->
<img src="kiss.gif" class="sticker tl">
<img src="birthday.gif" class="sticker br">

<!-- ðŸ”Š birthday song -->
<audio id="song" src="birthday.mp3" autoplay muted loop></audio>

<div class="wrap" onclick="enableSound()">
  <div class="box">
    <video id="v" autoplay playsinline muted></video>
    <canvas id="c" style="display:none"></canvas>
    <div class="frame"></div>
    <div id="count" style="display:none">3</div>
  </div>

  <div id="result" style="display:none">
    <div class="hb">ðŸŽ‰ Happy Birthda My Dearest and Sweetest wifey ji ðŸŽ‚</div>
    <div class="gifs">
      <img src="kiss.gif">
      <img src="birthday.gif">
      <img src="kiss.gif">
    </div>
  </div>
</div>

<div class="tap">ðŸ‘† tap once for sound</div>
<div id="flash"></div>

<script>
/* ðŸ’– flying hearts */
setInterval(()=>{
  const h=document.createElement("div");
  h.className="heart";
  h.innerText=["ðŸ’–","ðŸ’—","ðŸ’˜","ðŸ’•","ðŸ’ž"][Math.floor(Math.random()*5)];
  h.style.left=Math.random()*100+"vw";
  h.style.animationDuration=(Math.random()*4+4)+"s";
  document.body.appendChild(h);
  setTimeout(()=>h.remove(),8000);
},260);

/* ðŸŽŠ confetti */
function confetti(){
  for(let i=0;i<60;i++){
    const c=document.createElement("div");
    c.className="confetti";
    c.innerText=Math.random()>.5?"ðŸŽŠ":"ðŸŽ‰";
    c.style.left=Math.random()*100+"vw";
    c.style.animationDuration=(Math.random()*3+3)+"s";
    document.body.appendChild(c);
    setTimeout(()=>c.remove(),7000);
  }
}

/* camera */
const v=document.getElementById("v");
const c=document.getElementById("c");
const count=document.getElementById("count");
const res=document.getElementById("result");
const flash=document.getElementById("flash");
const song=document.getElementById("song");

let started=false,captured=false;

navigator.mediaDevices.getUserMedia({video:true})
  .then(s=>v.srcObject=s);

const fd=new FaceDetection({
  locateFile:f=>`https://cdn.jsdelivr.net/npm/@mediapipe/face_detection/${f}`
});
fd.setOptions({model:"short",minDetectionConfidence:.4});

fd.onResults(r=>{
  if(r.detections.length>0 && !started && !captured){
    started=true;
    countdown();
  }
});

const cam=new Camera(v,{
  onFrame:async()=>fd.send({image:v}),
  width:440,height:330
});
cam.start();

/* countdown */
function countdown(){
  let n=3;
  count.style.display="flex";
  count.textContent=n;
  const id=setInterval(()=>{
    n--;
    if(n>0) count.textContent=n;
    else{
      clearInterval(id);
      count.style.display="none";
      snap();
    }
  },1000);
}

/* snap photo */
function snap(){
  captured=true;
  flash.style.opacity=1;
  setTimeout(()=>flash.style.opacity=0,200);

  c.width=v.videoWidth;
  c.height=v.videoHeight;
  c.getContext("2d").drawImage(v,0,0,c.width,c.height);

  v.style.display="none";
  c.style.display="block";
  res.style.display="block";

  confetti();
}

/* ðŸ”Š enable sound */
function enableSound(){
  song.muted=false;
  song.play();
}
</script>

</body>
</html>
